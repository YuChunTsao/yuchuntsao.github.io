{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var c=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=>c(a,\"__esModule\",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{i(a);for(var t in s)c(a,t,{get:s[t],enumerable:!0})},g=(a,s,t)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of d(s))!u.call(a,n)&&n!==\"default\"&&c(a,n,{get:()=>s[n],enumerable:!(t=h(s,n))||t.enumerable});return a},y=a=>g(i(c(a!=null?p(m(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((j,o)=>{o.exports=_jsx_runtime});var x={};k(x,{default:()=>w,frontmatter:()=>f});var e=y(r()),f={title:\"Using PMTiles in Maplibre GL JS\",date:\"2023-02-19\",tags:[\"PMTiles\",\"Vector Tiles\",\"Maplibre GL JS\"],draft:!1,summary:null};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(t,{})})):t();function t(){let n=Object.assign({p:\"p\",code:\"code\",blockquote:\"blockquote\",ul:\"ul\",li:\"li\",a:\"a\",h2:\"h2\",span:\"span\",pre:\"pre\"},a.components),{MaplibreGL:l}=n;return l||M(\"MaplibreGL\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"In this article, I will use PMTiles in maplibre-gl-js. My vector tiles are generated by \",(0,e.jsx)(n.code,{children:\"felt/tippecanoe\"}),\" and saved in \",(0,e.jsx)(n.code,{children:\"PMTiles\"}),\" format. The input data is OpenStreetMap highway in taipei city. I created different road layers from the highway values, and use \",(0,e.jsx)(n.code,{children:\"tile-join\"}),\" to merge multiple layers.\"]}),(0,e.jsxs)(n.p,{children:[\"The \",(0,e.jsx)(n.code,{children:\"highway.pmtiles\"}),\" and \",(0,e.jsx)(n.code,{children:\"style.json\"}),\" is hosted on the github page.\"]}),(0,e.jsxs)(n.blockquote,{children:[(0,e.jsx)(n.p,{children:\"Related articles\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://yuchuntsao.github.io/blog/2023/import-osm-data-through-osm2pgsql-flex-output\",children:\"Import OSM data through osm2pgsql flex output\"})}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://yuchuntsao.github.io/blog/2023/create-vector-tiles-with-tippecanoe\",children:\"Create vector tiles with tippecanoe\"})})]})]}),(0,e.jsxs)(n.h2,{id:\"using-pmtiles-with-addprotocol\",children:[(0,e.jsx)(n.a,{href:\"#using-pmtiles-with-addprotocol\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Using PMTiles with addProtocol\"]}),(0,e.jsxs)(n.p,{children:[\"Follow \",(0,e.jsx)(n.a,{href:\"https://github.com/protomaps/PMTiles/tree/main/js\",children:\"the example\"}),\" of PMTiles, I changed the url of \",(0,e.jsx)(n.code,{children:\"style.json\"}),\" and \",(0,e.jsx)(n.code,{children:\"PMTiles\"}),\" to my source url and set the style for different road levels through mapbox style specification.\"]}),(0,e.jsx)(n.p,{children:\"The following is an example.\"}),(0,e.jsx)(l,{style:\"https://yuchuntsao.github.io/custom-vector-tiles/taipei-osm-highways/style.json\",isPMTiles:!0,PMTILES_URL:\"https://yuchuntsao.github.io/custom-vector-tiles/taipei-osm-highways/data/highways.pmtiles\"}),(0,e.jsxs)(n.p,{children:[\"Here is the javascript code of my example. The complete code can be found \",(0,e.jsx)(n.a,{href:\"https://github.com/YuChunTsao/custom-vector-tiles/tree/main/taipei-osm-highways\",children:\"here\"}),\".\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// add the PMTiles plugin to the maplibregl global.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" protocol \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsxs)(n.span,{className:\"token class-name\",children:[\"pmtiles\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Protocol\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"maplibregl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"addProtocol\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'pmtiles'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" protocol\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"tile\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token constant\",children:\"PMTILES_URL\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'https://yuchuntsao.github.io/custom-vector-tiles/taipei-osm-highways/data/highways.pmtiles'\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" p \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsxs)(n.span,{className:\"token class-name\",children:[\"pmtiles\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"PMTiles\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"PMTILES_URL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// this is so we share one instance across the JS code and the map renderer\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"protocol\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"add\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// we first fetch the header so we can get the center lon, lat of the map.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),` map\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getHeader\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"then\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"h\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  map \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsxs)(n.span,{className:\"token class-name\",children:[\"maplibregl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Map\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    container\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'map'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    style\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'https://yuchuntsao.github.io/custom-vector-tiles/taipei-osm-highways/style.json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"references\",children:[(0,e.jsx)(n.a,{href:\"#references\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"References\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://github.com/protomaps/PMTiles\",children:\"PMTiles\"})}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://maplibre.org/maplibre-gl-js-docs/api/properties/#addprotocol\",children:\"Maplibre GL JS - addProtocol\"})}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://docs.mapbox.com/mapbox-gl-js/style-spec/\",children:\"Mapbox Style Specification\"})})]})]})}}var w=b;function M(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return x;})();\n;return Component;","toc":[{"value":"Using PMTiles with addProtocol","url":"#using-pmtiles-with-addprotocol","depth":2},{"value":"References","url":"#references","depth":2}],"frontMatter":{"readingTime":{"text":"2 min read","minutes":1.67,"time":100200,"words":334},"slug":"2023/using-pmtiles-in-maplibre-gl-js","fileName":"2023/using-pmtiles-in-maplibre-gl-js.md","title":"Using PMTiles in Maplibre GL JS","date":"2023-02-19T00:00:00.000Z","tags":["PMTiles","Vector Tiles","Maplibre GL JS"],"draft":false,"summary":null}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"YuChun Tsao","avatar":"/static/images/avatar.png","occupation":null,"company":null,"email":"tsao84672776@gmail.com","twitter":null,"linkedin":null,"github":"https://github.com/YuChunTsao","date":null}],"prev":{"title":"Create vector tiles with tippecanoe","date":"2023-02-12T00:00:00.000Z","tags":["OpenStreetMap","Vector Tiles","Tippecanoe"],"draft":false,"summary":null,"slug":"2023/create-vector-tiles-with-tippecanoe"},"next":{"title":"How to create raster tiles with OSM data","date":"2023-02-26T00:00:00.000Z","tags":["OpenStreetMap","Raster Tiles","Docker"],"draft":false,"summary":null,"slug":"2023/how-to-create-raster-tiles-with-osm-data"}},"__N_SSG":true}